<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BJJ ë¡¤ ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸ â€” íƒ‘ vs ê°€ë“œ (ë¶„ì„ ë¦¬í¬íŠ¸)</title>
<meta name="description" content="ì£¼ì§“ìˆ˜ ë¡¤ ìŠ¤íƒ€ì¼ 11ë¬¸í•­ í…ŒìŠ¤íŠ¸: íƒ‘ í”Œë ˆì´ì–´ vs ê°€ë“œ í”Œë ˆì´ì–´ â€” ê²°ê³¼ë¥¼ ë¶„ì„ ë¦¬í¬íŠ¸ë¡œ ì œê³µí•©ë‹ˆë‹¤." />
<style>
  :root{
    --fg:#0f172a; --muted:#64748b; --bg:#ffffff; --card:#f8fafc;
    --accent:#2563eb; --accent2:#14b8a6; --warn:#f59e0b; --border:#e2e8f0;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Apple SD Gothic Neo','Noto Sans KR',Arial,sans-serif;color:var(--fg);background:linear-gradient(180deg,#fff,#f6f9ff 45%,#eef3ff)}
  .wrap{max-width:920px;margin:0 auto;padding:24px}
  header{margin:4px 0 16px}
  h1{font-size:28px;margin:0 0 6px}
  p.lead{color:var(--muted);margin:0}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;margin:12px 0}
  .q-title{font-weight:800;margin-bottom:10px}
  .opt{display:block;background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;cursor:pointer;margin:8px 0;transition:all .15s}
  .opt:hover{border-color:var(--accent)}
  input[type=radio]{accent-color:var(--accent);transform:scale(1.15);margin-right:8px}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
  button{border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .primary{background:var(--accent);color:#fff}
  .ghost{background:#fff;border:1px solid var(--border)}
  .success{background:var(--accent2);color:#fff}
  .muted{color:var(--muted)}
  .progress{height:8px;background:#eaeef4;border-radius:99px;overflow:hidden;margin:10px 0 6px}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),#6ee7b7)}
  .small{font-size:13px}
  .result h2{margin:8px 0 6px}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:860px){.grid{grid-template-columns:1.1fr 0.9fr}}
  .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;margin:4px 6px 0 0;font-size:12px}
  .footer{margin:20px 0;color:var(--muted);font-size:12px}
  .hidden{display:none}
  .sharebox{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  input.link{flex:1 1 260px;border:1px solid var(--border);border-radius:10px;padding:10px;background:#fff}
  .kpis{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .kbar{background:#fff;border:1px solid var(--border);border-radius:12px;padding:10px}
  .klabel{font-size:12px;color:var(--muted);margin-bottom:6px}
  .kfill{height:10px;background:linear-gradient(90deg,var(--accent),#60a5fa);border-radius:999px;width:0}
  .kfill2{height:10px;background:linear-gradient(90deg,#22c55e,#a3e635);border-radius:999px;width:0}
  .taglist{margin-top:6px}
  .callout{background:#fff;border:1px dashed var(--border);padding:10px;border-radius:12px}
  .warn{color:#b45309}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>BJJ ë¡¤ ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸ ğŸ§­</h1>
    <p class="lead">11ë¬¸í•­ìœ¼ë¡œ **íƒ‘ vs ê°€ë“œ** ì„±í–¥ì„ ì¸¡ì •í•˜ê³ , ê²°ê³¼ë¥¼ **ë¶„ì„ ë¦¬í¬íŠ¸**ë¡œ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.</p>
  </header>

  <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
  <div class="small muted" id="count">0 / 11</div>

  <form id="quiz" class="card"></form>

  <div class="actions">
    <button type="button" class="ghost" id="prevBtn">ì´ì „</button>
    <button type="button" class="primary" id="nextBtn">ë‹¤ìŒ</button>
    <button type="submit" class="success hidden" id="submitBtn">ê²°ê³¼ ë³´ê¸°</button>
  </div>

  <section id="result" class="card result hidden"></section>

  <div class="footer">â“’ 2025 MK Corporation â€¢ ì·¨ë¯¸ìš© í…ŒìŠ¤íŠ¸ì´ë©° ì‹¤ì œ í›ˆë ¨ì€ ì½”ì¹˜ì™€ ìƒì˜í•˜ì„¸ìš”.</div>
</div>

<script>
/* =========================
   ë¶„ë¥˜: íƒ‘ / ê°€ë“œ / (ìœ ë¨¸) ì• ë§¤
   - ì´ˆê¸° í™”ë©´ì—ëŠ” 'ì• ë§¤' ì–¸ê¸‰ ì—†ìŒ
   - ê²°ê³¼ê°€ ì• ë§¤í•˜ë©´ ìœ ë¨¸ëŸ¬ìŠ¤í•˜ê²Œ í‘œí˜„
   - ë¶„ì„ ë¦¬í¬íŠ¸: ì ìˆ˜, ì¼ê´€ì„±, í•µì‹¬ ë“œë¼ì´ë²„, ë³´ì™„ í¬ì¸íŠ¸
========================= */
const CATS = {
  TOP:   { key:"TOP",   name:"íƒ‘ í”Œë ˆì´ì–´",   desc:"íŒ¨ì‹±ê³¼ í¬ì§€ì…˜ ì»¨íŠ¸ë¡¤ë¡œ ìƒìœ„ì—ì„œ ì••ë°•í•©ë‹ˆë‹¤." },
  GUARD: { key:"GUARD", name:"ê°€ë“œ í”Œë ˆì´ì–´", desc:"í•˜ìœ„ í¬ì§€ì…˜ì—ì„œ ê°ì¢… ê°€ë“œë¡œ ì£¼ë„ê¶Œì„ ì¡ìŠµë‹ˆë‹¤." },
  NONE:  { key:"NONE",  name:"íŒë‹¨ ë³´ë¥˜(!)",  desc:"ì˜¤ëŠ˜ì€ ìš°ì£¼ê°€ ë‹¹ì‹ ì˜ ì„±í–¥ì„ ìˆ¨ê²¼ì–´ìš” ğŸ˜… ë‹¤ìŒ ë¡¤ì—ì„œ íŒíŠ¸ë¥¼ ë” ì£¼ì„¸ìš”!" }
};

// 11ë¬¸í•­ â€” guard/top ì¶• ì ìˆ˜ì™€ ë¶„ì„ íŒíŠ¸/íƒœê·¸ë¥¼ í•¨ê»˜ ìˆ˜ì§‘
const QUESTIONS = [
  { id:"pref", title:"1) ë¡¤ ì‹œì‘ ê¸°ë³¸ ì„ í˜¸ëŠ”?", options:[
    {label:"ì‹œíŒ… ê°€ë“œ/ê°€ë“œí’€", map:{guard:2, top:0}, hint:"ê°€ë“œí’€ ì„ í˜¸", tags:["ì‹œíŒ…ê°€ë“œ","ê°€ë“œí’€"]},
    {label:"í…Œì´í¬ë‹¤ìš´ìœ¼ë¡œ íƒ‘", map:{guard:0, top:2}, hint:"ì—…/ë‹¤ìš´ ìì‹ ê°", tags:["í…Œì´í¬ë‹¤ìš´","íƒ‘ì„ ì "]},
    {label:"ìƒëŒ€ ë”°ë¼ ìœ ì—°", map:{guard:1, top:1}, hint:"ì „ìˆ  ìœ ì—°ì„±", tags:["ì „ìˆ ìœ ì—°","ìƒëŒ€ëŒ€ì‘"]} ]},
  { id:"passing", title:"2) íŒ¨ìŠ¤ vs ìŠ¤ìœ• ì„±ê³µë¥ ?", options:[
    {label:"ìŠ¤ìœ•/ì„œë¸Œê°€ ë” ì˜ë¨", map:{guard:2, top:0}, hint:"ìŠ¤ìœ• ìœ„í˜‘", tags:["ìŠ¤ìœ•ì²´ì¸","ë°”í…€ì„œë¸Œ"]},
    {label:"íŒ¨ì‹±/ì»¨íŠ¸ë¡¤ì´ ê°•í•¨", map:{guard:0, top:2}, hint:"íŒ¨ì‹± ì••ë°•", tags:["ë‹ˆì»·/ë¡±ìŠ¤í…","ì‚¬ì´ë“œì»¨íŠ¸ë¡¤"]},
    {label:"ë¹„ìŠ·í•˜ë‹¤", map:{guard:1, top:1}, hint:"ê· í˜•í˜•", tags:["ë°¸ëŸ°ìŠ¤"]} ]},
  { id:"guards", title:"3) ì¦ê²¨ ì“°ëŠ” ê°€ë“œ íƒ€ì…?", options:[
    {label:"ë²„í„°í”Œë¼ì´/ë°ë¼/ë¼ì˜", map:{guard:2, top:0}, hint:"ëª¨ë¹Œ ê°€ë“œ", tags:["ë²„í„°í”Œë¼ì´","ë°ë¼íˆë°”"]},
    {label:"í´ë¡œì¦ˆë“œ/í•˜í”„â†’ìŠ¤ìœ•", map:{guard:2, top:0}, hint:"ì „í†µ ê°€ë“œ", tags:["í´ë¡œì¦ˆë“œ","í•˜í”„"]},
    {label:"ê°€ë“œë³´ë‹¨ íŒ¨ì‹±", map:{guard:0, top:2}, hint:"íŒ¨ìŠ¤ ì§€í–¥", tags:["íŒ¨ìŠ¤ì²´ì¸","ë² ì´ìŠ¤"]} ]},
  { id:"wrestle", title:"4) ë ˆìŠ¬ë§/ì—…ë‹¤ìš´ ìì‹ ê°?", options:[
    {label:"ë‚®ìŒ(ê°€ë“œí’€ í¸í•¨)", map:{guard:2, top:0}, hint:"ì—…ë‹¤ìš´ ë³´ì™„", tags:["ì—…ë‹¤ìš´ë³´ì™„"]},
    {label:"ë†’ìŒ(íƒ‘ ê°€ì ¸ê°)", map:{guard:0, top:2}, hint:"ì—…ë‹¤ìš´ ê°•ì ", tags:["ì—…ë‹¤ìš´ê°•ì "]},
    {label:"ë³´í†µ", map:{guard:1, top:1}, hint:"í‰ê· ", tags:["í‰ê· "]} ]},
  { id:"pace", title:"5) í…œí¬/ìš´ì˜ ìŠ¤íƒ€ì¼?", options:[
    {label:"ë¦¬ì•¡í‹°ë¸Œ(ì¹´ìš´í„°/ì„¸íŒ…)", map:{guard:2, top:1}, hint:"ë¦¬ì•¡í‹°ë¸Œ ìš´ì˜", tags:["ì¹´ìš´í„°","ì„¸íŒ…"]},
    {label:"í”„ë¡œì•¡í‹°ë¸Œ(ì••ë°•/íŒ¨ì‹±)", map:{guard:0, top:2}, hint:"í”„ë¡œì•¡í‹°ë¸Œ ì••ë°•", tags:["ì••ë°•","ë¼ì¸ë¸Œë ˆì´í¬"]},
    {label:"ìƒí™© ìŠ¤ìœ„ì¹˜", map:{guard:1, top:1}, hint:"ì „í™˜í˜•", tags:["ì „í™˜"]} ]},
  { id:"subs", title:"6) ì œì¶œê¸° ê²½í–¥?", options:[
    {label:"ì‚¼ê°/ì•”ë°” ë“± ë°”í…€ ì„œë¸Œ", map:{guard:2, top:0}, hint:"ë°”í…€ ì„œë¸Œ ì²´ì¸", tags:["ì‚¼ê°","ì•”ë°”"]},
    {label:"ì´ˆí¬/ì•„ë©”ë¦¬ì¹´ë‚˜ ë“± íƒ‘ ì„œë¸Œ", map:{guard:0, top:2}, hint:"íƒ‘ ì„œë¸Œ ì²´ì¸", tags:["ì´ˆí¬","ì•„ë©”ë¦¬ì¹´ë‚˜"]},
    {label:"ë‘˜ ë‹¤ ë‚˜ì˜¨ë‹¤", map:{guard:1, top:1}, hint:"ì´ì¤‘ ìœ„í˜‘", tags:["ì´ì¤‘ìœ„í˜‘"]} ]},
  { id:"passes", title:"7) ì£¼ë ¥ íŒ¨ìŠ¤/ë¸Œë ˆì´í¬ë‹¤ìš´?", options:[
    {label:"ê°€ë“œ ì „ê°œ/ì–¸ë°¸ëŸ°ì‹±", map:{guard:2, top:0}, hint:"ì–¸ë°¸ëŸ°ì‹±", tags:["ì–¸ë°¸ëŸ°ì‹±","ì—”íŠ¸ë¦¬"]},
    {label:"ë‹ˆì»·/ë¡±ìŠ¤í…/í† ë¦¬ì•ˆë„", map:{guard:0, top:2}, hint:"íŒ¨ìŠ¤ ì²´ì¸", tags:["ë‹ˆì»·","ë¡±ìŠ¤í…","í† ë¦¬ì•ˆë„"]},
    {label:"ìƒí™© ë”°ë¼ ì„ìŒ", map:{guard:1, top:1}, hint:"ë¯¹ìŠ¤ ì „ëµ", tags:["ë¯¹ìŠ¤"]} ]},
  { id:"pressure", title:"8) ì••ë°•/ë¬´ê²Œì¤‘ì‹¬ ì»¨íŠ¸ë¡¤?", options:[
    {label:"ì¤‘ê°„ ì´í•˜", map:{guard:1, top:0}, hint:"ì••ë°• ê³¼ì œ", tags:["ì••ë°•ë³´ì™„"]},
    {label:"ê°•í•˜ë‹¤", map:{guard:0, top:2}, hint:"ì••ë°• ê°•ì ", tags:["í—¤ë¹„í”„ë ˆì…”"]},
    {label:"ë³´í†µ", map:{guard:1, top:1}, hint:"í‰ê·  ì••ë°•", tags:["í‰ê· ì••ë°•"]} ]},
  { id:"retention", title:"9) ê°€ë“œ ë¦¬í…ì…˜ ìì‹ ê°?", options:[
    {label:"ë†’ìŒ", map:{guard:2, top:0}, hint:"ë¦¬í…ì…˜ ê°•ì ", tags:["ë¦¬í…ì…˜"]},
    {label:"ë‚®ìŒ", map:{guard:0, top:1}, hint:"ë¦¬í…ì…˜ ê³¼ì œ", tags:["ë¦¬í…ì…˜ë³´ì™„"]},
    {label:"ë³´í†µ", map:{guard:1, top:1}, hint:"ë³´í†µ", tags:["ë³´í†µ"]} ]},
  { id:"coach", title:"10) ì½”ì¹˜ê°€ ë” ê°•ì¡°í•˜ëŠ” ê±´?", options:[
    {label:"ê°€ë“œ ë””í…Œì¼", map:{guard:2, top:0}, hint:"ê°€ë“œ ë””í…Œì¼", tags:["ê·¸ë¦½/ê°ë„"]},
    {label:"íŒ¨ìŠ¤ ë””í…Œì¼", map:{guard:0, top:2}, hint:"íŒ¨ìŠ¤ ë””í…Œì¼", tags:["í—¤ë“œí¬ì§€ì…˜","ë² ì´ìŠ¤"]},
    {label:"ì „í™˜/íƒ€ì´ë°", map:{guard:1, top:1}, hint:"ì „í™˜ ë””í…Œì¼", tags:["íƒ€ì´ë°"]} ]},
  { id:"mind", title:"11) ì–´ë””ì„œ ë” ìì‹ ê°?", options:[
    {label:"ë°”í…€", map:{guard:2, top:0}, hint:"ë°”í…€ ìì‹ ê°", tags:["ë°”í…€ì„¸ì´í”„"]},
    {label:"íƒ‘", map:{guard:0, top:2}, hint:"íƒ‘ ìì‹ ê°", tags:["íƒ‘ì„¸ì´í”„"]},
    {label:"ë‘˜ ë‹¤", map:{guard:1, top:1}, hint:"ì–‘ë©´ ìì‹ ê°", tags:["ì–‘ë©´ì„¸ì´í”„"]} ]}
];

const quizEl = document.getElementById('quiz');
const barEl = document.getElementById('bar');
const countEl = document.getElementById('count');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const submitBtn = document.getElementById('submitBtn');
const resultEl = document.getElementById('result');

let currentIndex = 0;
const answers = {}; // id -> option index
const dim = { guard:0, top:0 };

function renderQuestion(i){
  quizEl.innerHTML = '';
  const q = QUESTIONS[i];
  const title = document.createElement('div');
  title.className='q-title';
  title.textContent = q.title;
  quizEl.appendChild(title);

  q.options.forEach((opt, idx) => {
    const label = document.createElement('label');
    label.className = 'opt';
    const input = document.createElement('input');
    input.type = 'radio';
    input.name = q.id;
    input.value = idx;
    input.checked = answers[q.id] === idx;
    input.addEventListener('change', ()=> { answers[q.id] = idx; updateNav(); });
    const span = document.createElement('span');
    span.textContent = opt.label;
    label.appendChild(input);
    label.appendChild(span);
    quizEl.appendChild(label);
  });

  updateProgress();
  updateNav();
}

function updateProgress(){
  const answered = Object.keys(answers).length;
  const pct = Math.round((answered/QUESTIONS.length)*100);
  barEl.style.width = pct + '%';
  countEl.textContent = `${Math.min(currentIndex+1, QUESTIONS.length)} / ${QUESTIONS.length}`;
}

function updateNav(){
  prevBtn.disabled = currentIndex===0;
  const q = QUESTIONS[currentIndex];
  const hasAnswer = answers[q.id] !== undefined;
  nextBtn.classList.toggle('hidden', currentIndex >= QUESTIONS.length-1);
  submitBtn.classList.toggle('hidden', currentIndex < QUESTIONS.length-1);
  nextBtn.disabled = !hasAnswer;
  submitBtn.disabled = !hasAnswer;
}

/* ======= ë¶„ì„ ë¡œì§ ======= */
function computeDims(){
  dim.guard = 0; dim.top = 0;
  Object.entries(answers).forEach(([qid, idx])=>{
    const opt = QUESTIONS.find(q=>q.id===qid).options[idx];
    dim.guard += opt.map.guard; dim.top += opt.map.top;
  });
  return dim;
}

// ì„ê³„ê°’: ì´ì  ë‚®ê±°ë‚˜, ê²©ì°¨ê°€ ì‘ì€ ê²½ìš° â†’ NONE(ìœ ë¨¸)
function classify(g, t){
  const total = g + t;
  const diff  = Math.abs(g - t);
  if (total <= 8) return CATS.NONE;      // ë°ì´í„° ë¶€ì¡±/ì¼ê´€ì„± ë‚®ìŒ
  if (diff <= 2)  return CATS.NONE;      // ê±°ì˜ ë¹„ë“±ë¹„ë“±
  return (g > t) ? CATS.GUARD : CATS.TOP;
}

function collectDrivers(){
  const hints = new Map();   // hint -> count
  const tags  = new Map();   // tag  -> count
  Object.entries(answers).forEach(([qid, idx])=>{
    const opt = QUESTIONS.find(q=>q.id===qid).options[idx];
    if (opt.hint) hints.set(opt.hint, (hints.get(opt.hint)||0)+1);
    (opt.tags||[]).forEach(t=> tags.set(t, (tags.get(t)||0)+1));
  });
  // ìƒìœ„ 5ê°œë§Œ ì¶”ë ¤ì„œ ë°˜í™˜
  const topHints = [...hints.entries()].sort((a,b)=>b[1]-a[1]).slice(0,5).map(([k])=>k);
  const topTags  = [...tags.entries()].sort((a,b)=>b[1]-a[1]).slice(0,8).map(([k])=>k);
  return { topHints, topTags };
}

function coachTipsFor(cat){
  if (cat.key === "TOP") return [
    "ë‹ˆì»·Â·ë¡±ìŠ¤í…Â·í† ë¦¬ì•ˆë„ 3ì²´ì¸ ì†ë„ ìœ ì§€",
    "í—¤ë“œí¬ì§€ì…˜/ì–¸ë”í›… ìš°ì„  â€” ë² ì´ìŠ¤ ê¹¨ì§€ì§€ ì•Šê¸°",
    "íŒ¨ìŠ¤â†’ì‚¬ì´ë“œâ†’ë§ˆìš´íŠ¸ 3ì´ˆ ê·œì¹™(ì»¨íŠ¸ë¡¤ ì‹œê°„ í™•ë³´)",
    "íƒ‘ ì„œë¸Œ(ì´ˆí¬/ì•”íŠ¸ë¼) í”¼ë‹ˆì‹œ ë£¨í‹´ ì •í˜•í™”"
  ];
  if (cat.key === "GUARD") return [
    "ë¦¬í…ì…˜ ë£¨í‹´(ê·¸ë€ë¹„/í™ìŠ¤ì¼€ì´í”„) 5ë¶„ ë“œë¦´",
    "ì–¸ë°¸ëŸ°ì‹±â†’ìŠ¤ìœ• 2-3ë‹¨ ì—°ê²°(ë²„í„°í”Œë¼ì´/ì‚¬ì´ì¦ˆì—…)",
    "ê°€ë“œì—ì„œ ì´ì¤‘ ìœ„í˜‘(ìŠ¤ìœ•+ì„œë¸Œ) ê°ë„ ë§Œë“¤ê¸°",
    "ê·¸ë¦½ íŒŒì´íŒ…/í”„ë ˆì„ ë””í…Œì¼(ì† ìœ„ì¹˜, ê°ë„, íƒ€ì´ë°)"
  ];
  // NONE (ìœ ë¨¸ + ê°œì„  í¬ì¸íŠ¸ ê°€ë³ê²Œ)
  return [
    "ì˜¤ëŠ˜ ì»¨ë””ì…˜: 'ëœë¤ ì…€ë ‰íŠ¸' ğŸ² â€” ë‹¤ìŒ ë¡¤ì—ì„œ ë‹¨ í•˜ë‚˜ì˜ ëª©í‘œë§Œ!",
    "ê°€ë“œ 1ì¢…Â·íŒ¨ìŠ¤ 1ì¢…ì„ 'ê³ ì •í”½'ìœ¼ë¡œ ì„ íƒí•´ ì„±ê³µë¥  ì²´í¬",
    "ì—…/ë‹¤ìš´ ê¸°ë³¸ê¸°(ìŠ¤íƒ ìŠ¤Â·ë ˆë²¨ì²´ì¸ì§€) 10ë¶„ ë£¨í‹´",
    "ìì£¼ ë§‰íˆëŠ” ìƒí™© í•˜ë‚˜ë§Œ ë©”ëª¨í•˜ê³  ë°”ë¡œ ë³µê¸°"
  ];
}

function showResult(){
  computeDims();
  const g = dim.guard, t = dim.top;
  const cat = classify(g, t);
  const total = g + t;
  const diff  = Math.abs(g - t);
  const guardPct = Math.round((g/22)*100);
  const topPct   = Math.round((t/22)*100);
  const consist  = (total>0) ? Math.round((diff/total)*100) : 0; // ì¼ê´€ì„± ì§€ìˆ˜(%)

  const { topHints, topTags } = collectDrivers();
  const tips = coachTipsFor(cat).map(t=>`<span class="pill">${t}</span>`).join('');

  // ê²°ê³¼ í—¤ë” ë¬¸êµ¬(ìœ ë¨¸ í¬í•¨)
  let headline = `ê²°ê³¼: ${cat.name}`;
  let subline  = cat.desc;
  if (cat.key === "NONE") {
    headline = "ê²°ê³¼: íŒë‹¨ ë³´ë¥˜ ğŸ˜…";
    subline  = "ê°€ë“œ/íƒ‘ ì§€í‘œê°€ ë¹„ìŠ·í•˜ê±°ë‚˜ ë°ì´í„°ê°€ ë¶€ì¡±í•´ìš”. ì˜¤ëŠ˜ì€ 'ë‹¤ì¬ë‹¤ëŠ¥'ìœ¼ë¡œ í¬ì¥í•´ë´…ì‹œë‹¤!";
  }

  // ê³µìœ  ë§í¬ (ì ìˆ˜ í¬í•¨)
  const payload = { g, t, v:2, cat:cat.key };
  const encoded = btoa(unescape(encodeURIComponent(JSON.stringify(payload))));
  const shareUrl = `${location.origin}${location.pathname}#r=${encoded}`;

  resultEl.innerHTML = `
    <h2>${headline}</h2>
    <div class="muted">${subline}</div>

    <div class="grid" style="margin-top:10px">
      <div class="card" style="background:#fff">
        <div class="kpis">
          <div class="kbar">
            <div class="klabel">ê°€ë“œ ì„±í–¥</div>
            <div class="kfill" id="kg" style="width:${guardPct}%"></div>
            <div class="small muted" style="margin-top:6px">${g} / 22 (${guardPct}%)</div>
          </div>
          <div class="kbar">
            <div class="klabel">íƒ‘ ì„±í–¥</div>
            <div class="kfill2" id="kt" style="width:${topPct}%"></div>
            <div class="small muted" style="margin-top:6px">${t} / 22 (${topPct}%)</div>
          </div>
        </div>

        <div class="callout" style="margin-top:12px">
          <div class="small muted">ì¼ê´€ì„± ì§€ìˆ˜</div>
          <div style="margin-top:4px;font-weight:700">${consist}%</div>
          <div class="small muted">â€» ê°’ì´ ë†’ì„ìˆ˜ë¡ í•œìª½ ì„±í–¥ì´ ëšœë ·í•©ë‹ˆë‹¤.</div>
        </div>
      </div>

      <div class="card" style="background:#fff">
        <div class="small muted">í•µì‹¬ ë“œë¼ì´ë²„(ë‹µë³€ íŒ¨í„´ ìš”ì•½)</div>
        <div class="taglist">
          ${topHints.map(h=>`<span class="pill">${h}</span>`).join('') || '<span class="pill">ë°ì´í„°ê°€ ë” í•„ìš”í•´ìš”</span>'}
        </div>
        <div class="small muted" style="margin-top:10px">ë‹¹ì‹ ì˜ íƒœê·¸</div>
        <div class="taglist">
          ${topTags.map(tg=>`<span class="pill">${tg}</span>`).join('') || '<span class="pill">â€”</span>'}
        </div>
      </div>
    </div>

    <div class="card" style="background:#fff;margin-top:12px">
      <div class="small muted">ì½”ì¹­ í¬ì¸íŠ¸(í›ˆë ¨ ì¶”ì²œ)</div>
      <div class="taglist">${tips}</div>
    </div>

    <div class="card" style="background:#fff;margin-top:12px">
      <div class="small muted">ê³µìœ </div>
      <div class="sharebox">
        <input class="link" id="shareLink" readonly value="${shareUrl}" />
        <button class="ghost" id="copyBtn">ë§í¬ ë³µì‚¬</button>
        <button class="primary" id="webshareBtn">ê³µìœ í•˜ê¸°</button>
        <button class="ghost" id="retryBtn">ë‹¤ì‹œí•˜ê¸°</button>
      </div>
    </div>
  `;
  resultEl.classList.remove('hidden');

  document.getElementById('copyBtn').onclick = async ()=>{
    try{
      const linkEl = document.getElementById('shareLink');
      linkEl.select(); linkEl.setSelectionRange(0, 99999);
      await navigator.clipboard.writeText(linkEl.value);
      alert('ê³µìœ  ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”!');
    }catch(e){ alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.'); }
  };
  document.getElementById('webshareBtn').onclick = async ()=>{
    const text = `ë‚´ BJJ ë¡¤ ìŠ¤íƒ€ì¼ ê²°ê³¼ â€” ê°€ë“œ:${g}, íƒ‘:${t}, ì¼ê´€ì„±:${consist}%`;
    const url = document.getElementById('shareLink').value;
    if (navigator.share){ try{ await navigator.share({title:'BJJ ë¡¤ ìŠ¤íƒ€ì¼', text, url}); }catch(_){}} 
    else { alert('ì´ ê¸°ê¸°ì—ì„œëŠ” ê¸°ë³¸ ê³µìœ ê°€ ì§€ì›ë˜ì§€ ì•Šì•„ìš”. ë§í¬ë¥¼ ë³µì‚¬í•´ ê³µìœ í•´ì£¼ì„¸ìš”!'); }
  };
  document.getElementById('retryBtn').onclick = ()=>{ location.hash=''; location.reload(); };
}

/* ========== ë„¤ë¹„ê²Œì´ì…˜ ========== */
prevBtn.addEventListener('click', ()=>{
  if(currentIndex>0) currentIndex--;
  renderQuestion(currentIndex);
});
nextBtn.addEventListener('click', ()=>{
  const q = QUESTIONS[currentIndex];
  if(answers[q.id]===undefined){ alert('ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
  if(currentIndex<QUESTIONS.length-1) currentIndex++;
  renderQuestion(currentIndex);
});
document.querySelector('form').addEventListener('submit', (e)=>{
  e.preventDefault();
  const q = QUESTIONS[currentIndex];
  if(answers[q.id]===undefined){ alert('ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
  showResult();
  window.scrollTo({top:0, behavior:'smooth'});
});

/* ========== í•´ì‹œ ë³µì›(ê³µìœ  ë§í¬) ========== */
function tryRestoreFromHash(){
  const m = location.hash.match(/#r=([^&]+)/);
  if(!m) return false;
  try{
    const json = decodeURIComponent(escape(atob(m[1])));
    const payload = JSON.parse(json);
    if (!payload || payload.v!==2) return false;
    // ê²°ê³¼ ë³´ê¸° ì „ìš© â€” ì ìˆ˜ë§Œ ë³µì›í•´ì„œ ë¦¬í¬íŠ¸ ë°”ë¡œ ë…¸ì¶œ
    Object.keys(answers).forEach(k=>delete answers[k]);
    // ë¯¸ë‹ˆ ë Œë”(ì§„í–‰ë°” ì±„ìš°ê¸°)
    currentIndex = QUESTIONS.length-1;
    renderQuestion(currentIndex);
    dim.guard = payload.g||0; dim.top = payload.t||0;
    showResult();
    return true;
  }catch(e){ return false; }
}

/* ì´ˆê¸° ë Œë” */
if(!tryRestoreFromHash()){ renderQuestion(0); }
</script>
</body>
</html>
