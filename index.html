<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BJJ ë¡¤ ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸ â€” ì „ë¬¸ê°€í˜•(28ë¬¸í•­)</title>
<meta name="description" content="ì£¼ì§“ìˆ˜ ë¡¤ ìŠ¤íƒ€ì¼ 28ë¬¸í•­: 7ê°€ì§€ ì¹´í…Œê³ ë¦¬(íƒ‘/ê°€ë“œ/ì˜¬ë¼ìš´ë”/ë ˆìŠ¬ëŸ¬/ë ˆê·¸ë½/ì„œë¸Œí—Œí„°/ì¹´ìš´í„°) ë¶„ì„ ë¦¬í¬íŠ¸" />
<style>
  :root{
    --fg:#0f172a; --muted:#64748b; --bg:#ffffff; --card:#f8fafc;
    --accent:#2563eb; --accent2:#14b8a6; --border:#e2e8f0;
    --ok:#60a5fa; --good:#22c55e; --warn:#f59e0b;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Apple SD Gothic Neo','Noto Sans KR',Arial,sans-serif;color:var(--fg);background:linear-gradient(180deg,#fff,#f6f9ff 45%,#eef3ff)}
  .wrap{max-width:1024px;margin:0 auto;padding:24px}
  header{margin:4px 0 16px}
  h1{font-size:28px;margin:0 0 6px}
  p.lead{color:var(--muted);margin:0}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:18px;margin:12px 0}
  .q-title{font-weight:800;margin-bottom:10px}
  .opt{display:block;background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;cursor:pointer;margin:8px 0;transition:all .15s}
  .opt:hover{border-color:var(--accent)}
  input[type=radio]{accent-color:var(--accent);transform:scale(1.15);margin-right:8px}
  .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
  button{border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .primary{background:var(--accent);color:#fff}
  .ghost{background:#fff;border:1px solid var(--border)}
  .success{background:var(--accent2);color:#fff}
  .muted{color:var(--muted)}
  .progress{height:8px;background:#eaeef4;border-radius:99px;overflow:hidden;margin:10px 0 6px}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),#6ee7b7)}
  .small{font-size:13px}
  .result h2{margin:8px 0 6px}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:960px){.grid{grid-template-columns:1.1fr 0.9fr}}
  .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;margin:4px 6px 0 0;font-size:12px}
  .footer{margin:20px 0;color:var(--muted);font-size:12px}
  .hidden{display:none}
  .sharebox{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  input.link{flex:1 1 260px;border:1px solid var(--border);border-radius:10px;padding:10px;background:#fff}
  .kpis{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .kbar{background:#fff;border:1px solid var(--border);border-radius:12px;padding:10px}
  .klabel{font-size:12px;color:var(--muted);margin-bottom:6px}
  .kfill{height:10px;background:linear-gradient(90deg,var(--ok),#a5b4fc);border-radius:999px;width:0}
  .kfill2{height:10px;background:linear-gradient(90deg,var(--good),#a3e635);border-radius:999px;width:0}
  .callout{background:#fff;border:1px dashed var(--border);padding:10px;border-radius:12px}
  .taglist{margin-top:6px}
  .hbar{background:#fff;border:1px solid var(--border);border-radius:10px;padding:8px;margin:6px 0}
  .hbar-fill{height:8px;border-radius:999px;background:linear-gradient(90deg,#60a5fa,#22d3ee);width:0;margin-top:6px}
  .cat-badge{display:inline-block;font-size:12px;padding:6px 10px;border-radius:999px;background:#fff;border:1px solid var(--border);margin-left:8px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>BJJ ë¡¤ ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸ ğŸ§­</h1>
    <p class="lead">28ë¬¸í•­ìœ¼ë¡œ <strong>íƒ‘/ê°€ë“œ/ë ˆìŠ¬ë§/ì••ë°•/í”Œë¡œìš°/ì„œë¸Œ/ì¹´ìš´í„°/ë ˆê·¸ë½</strong>ì„ ê³„ëŸ‰í™”í•˜ê³ , <strong>7ê°€ì§€ ì¹´í…Œê³ ë¦¬</strong>ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.</p>
  </header>

  <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
  <div class="small muted" id="count">0 / 28</div>

  <form id="quiz" class="card"></form>

  <div class="actions">
    <button type="button" class="ghost" id="prevBtn">ì´ì „</button>
    <button type="button" class="primary" id="nextBtn">ë‹¤ìŒ</button>
    <button type="button" class="success hidden" id="submitBtn">ê²°ê³¼ ë³´ê¸°</button>
  </div>

  <section id="result" class="card result hidden"></section>

  <div class="footer">Â© 2025 MK corporation â€¢ ì·¨ë¯¸ìš© í…ŒìŠ¤íŠ¸ì´ë©° ì‹¤ì œ í›ˆë ¨ì€ ì½”ì¹˜ì™€ ìƒì˜í•˜ì„¸ìš”.</div>
</div>

<script>
/* ========= ì¶•/ì¹´í…Œê³ ë¦¬ ========= */
const AXES = ["TOP","GUARD","WRESTLE","PRESSURE","FLOW","SUB","COUNTER","LEG"];
const AXIS_LABEL = {
  TOP:"íƒ‘(íŒ¨ì‹±/ì»¨íŠ¸ë¡¤)", GUARD:"ê°€ë“œ/ë¦¬í…ì…˜", WRESTLE:"ì—…/ë‹¤ìš´", PRESSURE:"ì••ë°•",
  FLOW:"ì „í™˜/í…œí¬", SUB:"ì„œë¸Œ ì²´ì¸", COUNTER:"ì¹´ìš´í„°/íŠ¸ë©", LEG:"ë ˆê·¸ë½ ì‹œìŠ¤í…œ"
};

const CATS = {
  TOP_SPECIALIST:  {key:"TOP_SPECIALIST",  name:"íƒ‘ ìŠ¤í˜ì…œë¦¬ìŠ¤íŠ¸",  desc:"íŒ¨ì‹± ì—°ê³„ì™€ ì••ë°•ìœ¼ë¡œ ìƒìœ„ë¥¼ ì¥ì•…í•©ë‹ˆë‹¤."},
  GUARD_SPECIALIST:{key:"GUARD_SPECIALIST",name:"ê°€ë“œ ìŠ¤í˜ì…œë¦¬ìŠ¤íŠ¸",desc:"ë¦¬í…ì…˜/ìŠ¤ìœ•/ë°”í…€ ì„œë¸Œë¡œ ì£¼ë„ê¶Œì„ ì¡ìŠµë‹ˆë‹¤."},
  ALL_ROUNDER:     {key:"ALL_ROUNDER",     name:"ì˜¬ë¼ìš´ë”",        desc:"íƒ‘Â·ê°€ë“œ ê· í˜•ì— ì „í™˜/ì˜ì‚¬ê²°ì •ì´ ê°•ì ì…ë‹ˆë‹¤."},
  WRESTLER_FIRST:  {key:"WRESTLER_FIRST",  name:"ë ˆìŠ¬ëŸ¬-í¼ìŠ¤íŠ¸ íƒ‘í¼",desc:"ìŠ¤íƒ ë”©â†’í…Œì´í¬ë‹¤ìš´â†’íƒ‘ ìœ ì§€ ë£¨íŠ¸ê°€ ê°•ë ¥í•©ë‹ˆë‹¤."},
  LEGLOCK_SYSTEM:  {key:"LEGLOCK_SYSTEM",  name:"ë ˆê·¸ë½ ì‹œìŠ¤í…œ",   desc:"ì•„ì‹œ/ì™¸ì• ì‹œ ì „í™˜ê³¼ í•˜ì²´ í”¼ë‹ˆì‹œ ìœ„í˜‘ì´ íŠ¹ì§•ì…ë‹ˆë‹¤."},
  SUBMISSION_HUNTER:{key:"SUBMISSION_HUNTER",name:"ì„œë¸Œë¯¸ì…˜ í—Œí„°", desc:"í¬ì§€ì…˜ë³´ë‹¤ í”¼ë‹ˆì‹œë¥¼ ë¨¼ì € ì„¸íŒ…í•˜ëŠ” ì„±í–¥ì…ë‹ˆë‹¤."},
  COUNTER_TEMPO:   {key:"COUNTER_TEMPO",   name:"ì¹´ìš´í„°-í…œí¬",     desc:"ë¦¬ì•¡í‹°ë¸Œ íŠ¸ë©ê³¼ í…œí¬ ì¡°ì ˆë¡œ ì‹¤ìˆ˜ë¥¼ ìœ ë„í•©ë‹ˆë‹¤."},
  UNDETERMINED:    {key:"UNDETERMINED",    name:"íŒë‹¨ ë³´ë¥˜ ğŸ˜…",     desc:"ì˜¤ëŠ˜ì€ ë‹¤ì¬ë‹¤ëŠ¥ìœ¼ë¡œ í¬ì¥í•´ë„ ê´œì°®ì•„ìš”!"}
};

/* ========= ë¬¸í•­(28) =========
   ê° ì˜µì…˜ì€ 8ì¶• ì¤‘ 1~2ê°œì— ê°€ì¤‘ì¹˜(+ tags/hints)
   ê°€ì¤‘ì¹˜ í•©ì´ ì¶•ì˜ 'ì ìˆ˜'ê°€ ë©ë‹ˆë‹¤.
*/
const Q = [
  {id:"start", title:"1) ì˜¤í”ˆ ë§¤íŠ¸ ì²« ì „ê°œëŠ”?", opts:[
    {t:"ì‹œíŒ…/ê°€ë“œí’€ë¡œ ê°ë„ë¶€í„°", map:{GUARD:2,FLOW:1}, tags:["ì‹œíŒ…","ê°€ë“œí’€","ì„¸íŒ…"]},
    {t:"ê·¸ë¦½íŒŒì´íŠ¸â†’TDë¡œ íƒ‘ ì„ ì ", map:{WRESTLE:2,TOP:1}, tags:["í…Œì´í¬ë‹¤ìš´","íƒ‘ì„ ì "]},
    {t:"ìƒëŒ€ ë³´ê³  ë¶„ê¸°", map:{FLOW:2}, tags:["ì „í™˜","íƒ€ì´ë°"]}
  ]},
  {id:"tempo", title:"2) í…œí¬ ìš´ì˜?", opts:[
    {t:"ë¦¬ì•¡í‹°ë¸Œ(ë°›ì•„ì¹˜ê¸°/ì„¸íŒ…)", map:{COUNTER:2,GUARD:1}, tags:["ì¹´ìš´í„°","ì„¸íŒ…"]},
    {t:"í”„ë¡œì•¡í‹°ë¸Œ(ë¼ì¸ ê¹¨ë©° ì••ë°•)", map:{PRESSURE:2,TOP:1}, tags:["ì••ë°•","ë¼ì¸ë¸Œë ˆì´í¬"]},
    {t:"ìƒí™© ìŠ¤ìœ„ì¹˜", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"guardtype", title:"3) ì¦ê²¨ ì“°ëŠ” ê°€ë“œ íƒ€ì…?", opts:[
    {t:"ë²„í„°í”Œë¼ì´/ë°ë¼/ë¼ì˜", map:{GUARD:2,FLOW:1}, tags:["ë²„í„°í”Œë¼ì´","ë°ë¼","ë¼ì˜"]},
    {t:"í´ë¡œì¦ˆë“œ/í•˜í”„ì—ì„œ ì…‹ì—…", map:{GUARD:2,SUB:1}, tags:["í´ë¡œì¦ˆë“œ","í•˜í”„"]},
    {t:"ê°€ë“œë³´ë‹¤ íŒ¨ì‹±", map:{TOP:2,PRESSURE:1}, tags:["ë‹ˆì»·","ë¡±ìŠ¤í…","í† ë¦¬ì•ˆë„"]}
  ]},
  {id:"passing", title:"4) íŒ¨ìŠ¤ ë£¨íŠ¸ ì„ í˜¸", opts:[
    {t:"íŒ¨ìŠ¤ë³´ë‹¤ ìŠ¤ìœ•/ì„œë¸Œ ê¸°íšŒ", map:{GUARD:2,SUB:1}, tags:["ì–¸ë°¸ëŸ°ì‹±","ì´ì¤‘ìœ„í˜‘"]},
    {t:"ë‹ˆì»·/ë¡±ìŠ¤í…/í† ë¦¬ì•ˆë„ ì²´ì¸", map:{TOP:2,PRESSURE:1}, tags:["ë‹ˆì»·","ë¡±ìŠ¤í…","í† ë¦¬ì•ˆë„"]},
    {t:"ìƒí™©ë³„ ë¯¹ìŠ¤", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"retention", title:"5) ë¦¬í…ì…˜ ìì‹ ê°", opts:[
    {t:"ë†’ìŒ(í™/ê·¸ë€ë¹„ë¡œ ë³µê·€)", map:{GUARD:2,FLOW:1}, tags:["ë¦¬í…ì…˜","ê·¸ë€ë¹„"]},
    {t:"ë‚®ìŒ(íŒ¨ìŠ¤ ì‰½ê²Œ ì—´ë¦¼)", map:{TOP:1}, tags:["ë¦¬í…ì…˜ë³´ì™„"]},
    {t:"ë³´í†µ", map:{GUARD:1}, tags:["ë³´í†µ"]}
  ]},
  {id:"pressure", title:"6) ì••ë°•/ë¬´ê²Œì¤‘ì‹¬", opts:[
    {t:"ì¤‘ê°„ ì´í•˜", map:{GUARD:1}, tags:["ì••ë°•ë³´ì™„"]},
    {t:"ê°•í•¨(ì‚¬ì´ë“œ/ë§ˆìš´íŠ¸ ìœ ì§€ ì‰¬ì›€)", map:{PRESSURE:2,TOP:1}, tags:["í—¤ë¹„í”„ë ˆì…”","ë² ì´ìŠ¤"]},
    {t:"ë³´í†µ", map:{PRESSURE:1}, tags:["ë³´í†µ"]}
  ]},
  {id:"wrestle", title:"7) ì—…/ë‹¤ìš´(ë ˆìŠ¬ë§)", opts:[
    {t:"ë‚®ìŒ(ê°€ë“œí’€ í¸í•¨)", map:{GUARD:2}, tags:["ì—…ë‹¤ìš´ë³´ì™„"]},
    {t:"ë†’ìŒ(TDâ†’íƒ‘ ìœ ì§€ ìì‹ )", map:{WRESTLE:2,TOP:1}, tags:["ì—…ë‹¤ìš´ê°•ì ","í…Œì´í¬ë‹¤ìš´"]},
    {t:"ë³´í†µ", map:{WRESTLE:1}, tags:["ë³´í†µ"]}
  ]},
  {id:"grips", title:"8) ê·¸ë¦½/í”„ë ˆì„ ë””í…Œì¼", opts:[
    {t:"ê·¸ë¦½Â·í”„ë ˆì„ ìì‹  ìˆìŒ", map:{GUARD:2,COUNTER:1}, tags:["ê·¸ë¦½","í”„ë ˆì„"]},
    {t:"í—¤ë“œí¬ì§€ì…˜/ì–¸ë”í›…/ë² ì´ìŠ¤", map:{PRESSURE:2,TOP:1}, tags:["í—¤ë“œí¬ì§€ì…˜","ì–¸ë”í›…","ë² ì´ìŠ¤"]},
    {t:"ë‘˜ ë‹¤ ìƒí™©ë³„", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"subsB", title:"9) ë°”í…€ ì„œë¸Œ", opts:[
    {t:"ì‚¼ê°/ì•”ë°”/ì˜´í”Œ ìì£¼", map:{SUB:2,GUARD:1}, tags:["ì‚¼ê°","ì•”ë°”"]},
    {t:"ê±°ì˜ ì•ˆ ë…¸ë¦¼", map:{TOP:1}, tags:[]},
    {t:"ìƒí™© ë”°ë¼", map:{SUB:1}, tags:["ì´ì¤‘ìœ„í˜‘"]}
  ]},
  {id:"subsT", title:"10) íƒ‘ ì„œë¸Œ", opts:[
    {t:"ì´ˆí¬/ì•„ë©”ë¦¬ì¹´ë‚˜/ì•”íŠ¸ë¼", map:{SUB:2,TOP:1}, tags:["ì´ˆí¬","ì•„ë©”ë¦¬ì¹´ë‚˜"]},
    {t:"ì»¨íŠ¸ë¡¤ ìœ„ì£¼(ì„œë¸ŒëŠ” ë³´ë„ˆìŠ¤)", map:{TOP:2}, tags:["ë² ì´ìŠ¤"]},
    {t:"ë‘˜ ë‹¤ ë…¸ë¦¼", map:{SUB:1,TOP:1}, tags:["ì´ì¤‘ìœ„í˜‘"]}
  ]},
  {id:"inv", title:"11) ì¸ë²„ì „ í™œìš©", opts:[
    {t:"ìì£¼(ì—”íŠ¸ë¦¬/ë¦¬í…ì…˜)", map:{GUARD:2,FLOW:1}, tags:["ì¸ë²„ì „"]},
    {t:"ê°€ë”", map:{GUARD:1}, tags:["ì¸ë²„ì „"]},
    {t:"ê±°ì˜ ì•ˆ í•¨(íŒ¨ìŠ¤/ì••ë°• ì§€í–¥)", map:{TOP:2,PRESSURE:1}, tags:["ì••ë°•"]}
  ]},
  {id:"gameplan", title:"12) ê²Œì„í”Œëœ ì² í•™", opts:[
    {t:"ëŒ€ì‘í˜•(ë°˜ì‘ ìœ ë„)", map:{COUNTER:2,GUARD:1}, tags:["ì¹´ìš´í„°","ì„¸íŒ…"]},
    {t:"ì£¼ë„í˜•(ë¼ì¸ ê¹¨ê³  ì••ë°•)", map:{PRESSURE:2,TOP:1}, tags:["ì••ë°•"]},
    {t:"ìƒí™©í˜•(ë“ì  ìš°ì„ ìˆœìœ„ ìœ ë™)", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"scramble", title:"13) ìŠ¤í¬ë¨ë¸” ì„ í˜¸", opts:[
    {t:"ë¦¬ìŠ¤í¬ ì ê²Œ, ê°ë„ ë§Œë“¤ê¸°", map:{COUNTER:1,GUARD:1}, tags:["ì„¸íŒ…"]},
    {t:"ê°•í•˜ê²Œ ë°€ì–´ë¶™ì—¬ ìƒìœ„ í™•ë³´", map:{TOP:2,WRESTLE:1}, tags:["ë² ì´ìŠ¤","ì••ë°•"]},
    {t:"ì¼€ì´ìŠ¤ ë°”ì´ ì¼€ì´ìŠ¤", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"stand", title:"14) ìŠ¤íƒ ë”© ë£¨í‹´", opts:[
    {t:"í’€/ì‹œíŒ…ìœ¼ë¡œ ì „ê°œ", map:{GUARD:2}, tags:["ì‹œíŒ…","ê°€ë“œí’€"]},
    {t:"ê·¸ë¦½íŒŒì´íŠ¸â†’ë ˆë²¨ì²´ì¸ì§€â†’TD", map:{WRESTLE:2,TOP:1}, tags:["í…Œì´í¬ë‹¤ìš´","í—¤ë“œí¬ì§€ì…˜"]},
    {t:"ìƒëŒ€ ë”°ë¼ ë¶„ê¸°", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"passDetail", title:"15) íŒ¨ìŠ¤ ë””í…Œì¼", opts:[
    {t:"ê°ë„/ë¬´ë¦ì‰´ë“œ í•´ì²´ ìì‹ ", map:{TOP:2,PRESSURE:1}, tags:["ë‹ˆì»·","í—¤ë“œí¬ì§€ì…˜"]},
    {t:"ë³´í†µ", map:{TOP:1}, tags:["ë² ì´ìŠ¤"]},
    {t:"ë‚®ìŒ", map:{GUARD:1}, tags:["íŒ¨ìŠ¤ë³´ì™„"]}
  ]},
  {id:"retDetail", title:"16) ë¦¬í…ì…˜/í”„ë ˆì„ ë””í…Œì¼", opts:[
    {t:"ê°ë„Â·í”„ë ˆì„ ì „í™˜ ë””í…Œì¼ ì¢‹ìŒ", map:{GUARD:2,COUNTER:1}, tags:["ë¦¬í…ì…˜","í”„ë ˆì„"]},
    {t:"ë³´í†µ", map:{GUARD:1}, tags:["í”„ë ˆì„"]},
    {t:"ë‚®ìŒ", map:{TOP:1}, tags:["ë¦¬í…ì…˜ë³´ì™„"]}
  ]},
  {id:"finishPref", title:"17) ë“ì  ìš°ì„ ìˆœìœ„", opts:[
    {t:"ìŠ¤ìœ•/ì„œë¸Œ ë¨¼ì €", map:{SUB:2,GUARD:1}, tags:["ì´ì¤‘ìœ„í˜‘"]},
    {t:"íŒ¨ìŠ¤/ì»¨íŠ¸ë¡¤ ë¨¼ì €", map:{TOP:2,PRESSURE:1}, tags:["ë² ì´ìŠ¤","ì••ë°•"]},
    {t:"ìƒí™© ë”°ë¼", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"mind", title:"18) ì‹¬ë¦¬ì  ì•ˆì „ì§€ëŒ€", opts:[
    {t:"ë°”í…€ì—ì„œ ì¡°ë¦½í•  ë•Œ", map:{GUARD:2}, tags:["ë°”í…€ì„¸ì´í”„"]},
    {t:"íƒ‘ì—ì„œ ëˆ„ë¥´ê³  ê¹° ë•Œ", map:{TOP:2,PRESSURE:1}, tags:["íƒ‘ì„¸ì´í”„"]},
    {t:"ë‘˜ ë‹¤ ê´œì°®ìŒ", map:{FLOW:2}, tags:["ì–‘ë©´ì„¸ì´í”„"]}
  ]},
  {id:"meta", title:"19) ë…¸ê¸° ë©”íƒ€ ì ì‘", opts:[
    {t:"ë…¸ê¸°ì—ì„œë„ ê°€ë“œÂ·ì—”íŠ¸ë¦¬ ì˜ë¨", map:{GUARD:2,COUNTER:1}, tags:["ë²„í„°í”Œë¼ì´"]},
    {t:"ë…¸ê¸°ì—ì„  íŒ¨ì‹±/ì••ë°•ì´ ë” ì˜ë¨", map:{TOP:2,PRESSURE:1}, tags:["ì••ë°•"]},
    {t:"ë‘˜ ë‹¤ ë¹„ìŠ·", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]},
  {id:"counter", title:"20) ì¹´ìš´í„° ë¬´ê¸°", opts:[
    {t:"ê¸¸ë¡œí‹´/ë°±í…Œì´í¬ íŠ¸ë© ë³´ìœ ", map:{COUNTER:2,SUB:1}, tags:["ê¸¸ë¡œí‹´","ë°±í…Œì´í¬"]},
    {t:"íŒ¨ìŠ¤ ì¹´ìš´í„°(ë¦¬ê·¸ë¦½/ë² ì´ìŠ¤)", map:{TOP:2,COUNTER:1}, tags:["ë¦¬ê·¸ë¦½","ë² ì´ìŠ¤"]},
    {t:"íŠ¹ë³„í•œ íŠ¸ë© ì—†ìŒ", map:{FLOW:1}, tags:[]}
  ]},
  {id:"legEntry", title:"21) ë ˆê·¸ ì—”íŠ¸ë¦¬ ë¹ˆë„", opts:[
    {t:"ìì£¼(ì•„ì‹œ/ì™¸ì• ì‹œ ì „í™˜)", map:{LEG:2,COUNTER:1}, tags:["ì•„ì‹œ","ì™¸ì• ì‹œ"]},
    {t:"ê°€ë”", map:{LEG:1}, tags:["ë ˆê·¸"]},
    {t:"ê±°ì˜ ì•ˆ ì”€", map:{TOP:1}, tags:[]}
  ]},
  {id:"legFinish", title:"22) ë ˆê·¸ í”¼ë‹ˆì‹œ ë””í…Œì¼", opts:[
    {t:"íí›…/ë‹ˆë°” ë“± ë§ˆë¬´ë¦¬ ìì‹ ", map:{LEG:2,SUB:1}, tags:["íí›…","ë‹ˆë°”"]},
    {t:"ë„ì¤‘ ì´íƒˆ/ìŠ¤íƒ ì—… ì „í™˜", map:{FLOW:1,COUNTER:1}, tags:["ì „í™˜"]},
    {t:"ì‹œë„ ë“œë¬¾", map:{TOP:1}, tags:[]}
  ]},
  {id:"transition", title:"23) í¬ì§€ì…˜ ì „í™˜ ì†ë„", opts:[
    {t:"ë¹ ë¦„(ì²´ì¸ ì—°ê²° ë§¤ë„ëŸ½ë‹¤)", map:{FLOW:2}, tags:["ì—°ê²°"]},
    {t:"ë³´í†µ", map:{FLOW:1}, tags:["ë³´í†µ"]},
    {t:"ëŠë¦° í¸(ê³ ì • ì§€í–¥)", map:{PRESSURE:1,TOP:1}, tags:["ê³ ì •"]}
  ]},
  {id:"controlTime", title:"24) ì»¨íŠ¸ë¡¤ ì‹œê°„ í™•ë³´", opts:[
    {t:"íŒ¨ìŠ¤ í›„ 3~5ì´ˆ ì•ˆì • í™•ë³´", map:{PRESSURE:2,TOP:1}, tags:["ì»¨íŠ¸ë¡¤ì‹œê°„"]},
    {t:"ì•ˆì • ì „ì— ì „í™˜/ì„œë¸Œ ì‹œë„", map:{FLOW:1,SUB:1}, tags:["ì „í™˜"]},
    {t:"ë§¤ë²ˆ ë‹¤ë¦„", map:{FLOW:1}, tags:["ë³€ë™"]}
  ]},
  {id:"study", title:"25) í•™ìŠµ ë£¨í‹´", opts:[
    {t:"ì‹œìŠ¤í…œ(ì—°ê²°/ì˜ì‚¬ê²°ì •) ìœ„ì£¼", map:{FLOW:2,COUNTER:1}, tags:["ì‹œìŠ¤í…œ"]},
    {t:"íŒ¨ìŠ¤/ì••ë°• ë“œë¦´ ë°˜ë³µ", map:{TOP:1,PRESSURE:2}, tags:["ë“œë¦´"]},
    {t:"ê°€ë“œ ë¦¬í…ì…˜Â·ì—”íŠ¸ë¦¬ ë°˜ë³µ", map:{GUARD:2}, tags:["ë¦¬í…ì…˜ë£¨í‹´"]}
  ]},
  {id:"review", title:"26) ìµœê·¼ ë¡¤ í”¼ë“œë°±", opts:[
    {t:"ê°€ë“œ ì „ê°œ/ë¦¬í…ì…˜ ì¹­ì°¬ å¤š", map:{GUARD:2}, tags:["ë¦¬í…ì…˜","ì–¸ë°¸ëŸ°ì‹±"]},
    {t:"íŒ¨ìŠ¤/ì»¨íŠ¸ë¡¤ ì¹­ì°¬ å¤š", map:{TOP:2,PRESSURE:1}, tags:["ë‹ˆì»·","í—¤ë“œí¬ì§€ì…˜"]},
    {t:"íŠ¹ì§• ë¶„ì‚°(ê°•ì  ëª¨í˜¸)", map:{FLOW:1}, tags:["ë¶„ì‚°"]}
  ]},
  {id:"risk", title:"27) ë¦¬ìŠ¤í¬ ì„±í–¥", opts:[
    {t:"ë‚®ê²Œ(í¬ì§€ì…˜ ìš°ì„ )", map:{PRESSURE:1,TOP:1}, tags:["ë¦¬ìŠ¤í¬ê´€ë¦¬"]},
    {t:"ì¤‘ê°„", map:{FLOW:1}, tags:["ê· í˜•"]},
    {t:"ë†’ê²Œ(í”¼ë‹ˆì‹œ ì‹œë„ ë§ìŒ)", map:{SUB:2,COUNTER:1}, tags:["í”¼ë‹ˆì‹œì§€í–¥"]}
  ]},
  {id:"fatigue", title:"28) í”¼ë¡œ ì‹œ ì„ íƒ ê²½í–¥", opts:[
    {t:"íƒ‘ ê³ ì •/ì••ë°•ìœ¼ë¡œ ì†ë„ ë‚®ì¶¤", map:{PRESSURE:2,TOP:1}, tags:["ì—ë„ˆì§€ì„¸ì´ë¸Œ"]},
    {t:"ê°€ë“œë¡œ ê°ë„/íŠ¸ë©ìœ¼ë¡œ ëŒ€ì‘", map:{GUARD:2,COUNTER:1}, tags:["íŠ¸ë©"]},
    {t:"ì „í™˜ìœ¼ë¡œ íë¦„ ìœ ì§€", map:{FLOW:2}, tags:["ì „í™˜"]}
  ]}
];

/* ========= ìƒíƒœ ========= */
const barEl = document.getElementById('bar');
const countEl = document.getElementById('count');
const quizEl = document.getElementById('quiz');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const submitBtn = document.getElementById('submitBtn');
const resultEl = document.getElementById('result');

let idx = 0;
const answers = {};                  // {id: optionIndex}
const score = Object.fromEntries(AXES.map(a=>[a,0]));
const tagCount = new Map();

/* ========= ë Œë”ë§ ========= */
function renderQuestion(i){
  const q = Q[i];
  quizEl.innerHTML = '';
  const title = document.createElement('div');
  title.className = 'q-title';
  title.textContent = q.title;
  quizEl.appendChild(title);

  q.opts.forEach((o, oi)=>{
    const label = document.createElement('label');
    label.className = 'opt';
    const input = document.createElement('input');
    input.type = 'radio'; input.name = q.id; input.value = oi;
    input.checked = answers[q.id] === oi;
    input.addEventListener('change', ()=>{
      answers[q.id] = oi;
      updateNav(); updateProgress();
    });
    const span = document.createElement('span'); span.textContent = o.t;
    label.appendChild(input); label.appendChild(span);
    quizEl.appendChild(label);
  });

  updateNav(); updateProgress();
}
function updateProgress(){
  const answered = Object.keys(answers).length;
  const pct = Math.round((answered/Q.length)*100);
  barEl.style.width = pct+'%';
  countEl.textContent = `${Math.min(idx+1, Q.length)} / ${Q.length}`;
}
function updateNav(){
  prevBtn.disabled = idx===0;
  const q = Q[idx];
  const has = answers[q.id] !== undefined;
  nextBtn.classList.toggle('hidden', idx >= Q.length-1);
  submitBtn.classList.toggle('hidden', idx < Q.length-1);
  nextBtn.disabled = !has;
  submitBtn.disabled = (idx >= Q.length-1) ? !has : true;
}

/* ========= ì ìˆ˜ ì§‘ê³„ ========= */
function computeScores(){
  // reset
  AXES.forEach(a=>score[a]=0);
  tagCount.clear();

  for (const q of Q){
    const oi = answers[q.id];
    if (oi===undefined) continue;
    const opt = q.opts[oi];
    for (const [axis,w] of Object.entries(opt.map)) score[axis]+=w;
    (opt.tags||[]).forEach(t=> tagCount.set(t, (tagCount.get(t)||0)+1));
  }
  return score;
}

/* ========= ì¹´í…Œê³ ë¦¬ ìŠ¤ì½”ì–´(ê°€ì¤‘ í•©) & íŒì • ========= */
const MAX_PER_AXIS =  (/* avg weights */ 3) * Q.length / 4 * 2; // rough display cap
const TH = { // ìƒëŒ€ì  ì„ê³„
  HIGH:  (sum)=> percentile(sum, 0.75),
  MID:   (sum)=> percentile(sum, 0.6),
  DELTA: 4,  // TOP-GUARD ë¶„ë¦¬
  EPS:   3,  // ê· í˜• í—ˆìš©
  MINTOTAL: 20,
  ENTROPY: 0.12
};

function percentile(s, p){
  // ê°„ë‹¨: ì „ì²´ì¶• í‰ê· ì„ ê¸°ì¤€ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§ (ì •êµ í†µê³„ ì•„ë‹˜)
  const vals = AXES.map(a=>s[a]);
  const sorted = [...vals].sort((a,b)=>a-b);
  const i = Math.floor(p*(sorted.length-1));
  return sorted[i];
}
function entropyLike(s){
  const sum = AXES.reduce((a,k)=>a+s[k],0) || 1;
  const probs = AXES.map(k=>s[k]/sum);
  const mean = probs.reduce((a,b)=>a+b,0)/probs.length;
  const varc = probs.reduce((a,p)=>a+(p-mean)**2,0)/probs.length;
  return varc; // ë¶„ì‚° ì‘ìœ¼ë©´ ê³ ë¥´ê²Œ ë¶„í¬(=ì• ë§¤)
}
function ruleClassify(s){
  const diffTG = Math.abs(s.TOP - s.GUARD);
  const total  = AXES.reduce((a,k)=>a+s[k],0);
  const high = (a)=> s[a] >= TH.HIGH(s);
  const mid  = (a)=> s[a] >= TH.MID(s);

  const cands = [];
  if (high("TOP") && high("PRESSURE") && (s.TOP - s.GUARD) >= TH.DELTA) cands.push(CATS.TOP_SPECIALIST);
  if (high("GUARD") && (s.GUARD - s.TOP) >= TH.DELTA && ( (tagCount.get("ë¦¬í…ì…˜")||0) + (tagCount.get("ê·¸ë€ë¹„")||0) >= 2)) cands.push(CATS.GUARD_SPECIALIST);
  if (high("TOP") && high("GUARD") && diffTG <= TH.EPS && mid("FLOW")) cands.push(CATS.ALL_ROUNDER);
  if (high("WRESTLE") && mid("TOP")) cands.push(CATS.WRESTLER_FIRST);
  if (high("LEG") && (mid("COUNTER") || mid("FLOW"))) cands.push(CATS.LEGLOCK_SYSTEM);
  if (high("SUB") && (mid("FLOW") || mid("TOP") || mid("GUARD"))) cands.push(CATS.SUBMISSION_HUNTER);
  if (high("COUNTER") && mid("FLOW") && s.WRESTLE < TH.HIGH(s)) cands.push(CATS.COUNTER_TEMPO);

  const entropy = entropyLike(s);
  if (cands.length===0 && (total < TH.MINTOTAL || entropy < TH.ENTROPY)) return CATS.UNDETERMINED;

  // í›„ë³´ ë‹¤ìˆ˜ë©´ ìŠ¤ì½”ì–´ ê¸°ë°˜ íƒ€ì´ë¸Œë ˆì´í¬
  if (cands.length>0){
    const catScore = categoryWeightedScores(s);
    cands.sort((a,b)=> (catScore[b.key]||0) - (catScore[a.key]||0));
    return cands[0];
  }
  return CATS.UNDETERMINED;
}
function categoryWeightedScores(s){
  // ì¹´í…Œê³ ë¦¬ë³„ ì¶• ê°€ì¤‘ í•©(ëŒ€ëµì )
  const W = {
    TOP_SPECIALIST:  {TOP:3,PRESSURE:2,WRESTLE:1,FLOW:1},
    GUARD_SPECIALIST:{GUARD:3,SUB:1,FLOW:1,COUNTER:1},
    ALL_ROUNDER:     {TOP:2,GUARD:2,FLOW:2},
    WRESTLER_FIRST:  {WRESTLE:3,TOP:2,PRESSURE:1},
    LEGLOCK_SYSTEM:  {LEG:3,COUNTER:2,FLOW:1},
    SUBMISSION_HUNTER:{SUB:3,FLOW:1,TOP:1,GUARD:1},
    COUNTER_TEMPO:   {COUNTER:3,FLOW:2,GUARD:1}
  };
  const out = {};
  for (const [cat,weights] of Object.entries(W)){
    let v=0; for (const [axis,w] of Object.entries(weights)) v += (s[axis]||0)*w;
    out[cat]=v;
  }
  return out;
}
function pickSecondary(main, s){
  const all = categoryWeightedScores(s);
  delete all[main.key];
  // ë³´ì¡°ëŠ” UNDETERMINED ì œì™¸, ì ìˆ˜ 2ìœ„
  delete all["UNDETERMINED"];
  const arr = Object.entries(all).sort((a,b)=>b[1]-a[1]);
  if (!arr.length) return null;
  const key = arr[0][0];
  // ê°„ë‹¨ ë³´í˜¸: 2ìœ„ ì ìˆ˜ê°€ ë„ˆë¬´ ë‚®ìœ¼ë©´ í‘œì‹œ ìƒëµ
  return CATS[key] || null;
}

/* ========= ì‹œê°í™” ========= */
function hbar(name, value, max){
  const pct = Math.round(max ? (value/max)*100 : 0);
  return `
    <div class="hbar">
      <div class="small muted">${name} <span style="float:right">${value}</span></div>
      <div class="hbar-fill" style="width:${pct}%"></div>
    </div>`;
}

/* ========= ê²°ê³¼ ========= */
function showResult(){
  // ì²´í¬ ëˆ„ë½ ë°©ì§€
  const left = Q.filter(q=>answers[q.id]===undefined).length;
  if (left>0){ alert(`ì•„ì§ ${left}ê°œ í•­ëª©ì´ ë‚¨ì•˜ìŠµë‹ˆë‹¤.`); return; }

  computeScores();
  const totalPerAxisMax = 3 * Q.length; // ì‹œê°í™” ìº¡(ëŒ€ëµ ë„‰ë„‰íˆ)
  const guardPct = Math.round(100*score.GUARD/totalPerAxisMax);
  const topPct   = Math.round(100*score.TOP/totalPerAxisMax);

  const main = ruleClassify(score);
  const sub  = pickSecondary(main, score);

  // ì¼ê´€ì„± ì§€ìˆ˜: ìƒìœ„ì¶• í‰ê·  ëŒ€ë¹„ í•˜ìœ„ì¶• í‰ê·  ê°„ê²©(ê°„ë‹¨í˜•)
  const vals = AXES.map(a=>score[a]);
  const sorted = [...vals].sort((a,b)=>b-a);
  const hi = (sorted[0]+sorted[1])/2, lo = (sorted[sorted.length-1]+sorted[sorted.length-2])/2;
  const consist = Math.max(0, Math.round((hi - lo) / (hi||1) * 100));

  // ìƒìœ„ íƒœê·¸/ë“œë¼ì´ë²„
  const topTags = [...tagCount.entries()].sort((a,b)=>b[1]-a[1]).slice(0,10).map(([k])=>k);
  const topDrivers = Object.entries(score).sort((a,b)=>b[1]-a[1]).slice(0,4).map(([k])=>AXIS_LABEL[k]);

  // ì¶• ë§‰ëŒ€(ìƒìœ„ 8 ëª¨ë‘)
  const axisBars = AXES.map(a=>hbar(AXIS_LABEL[a], score[a], totalPerAxisMax)).join('');

  // ì½”ì¹­ íŒ
  const tips = (()=>{
    switch(main.key){
      case "TOP_SPECIALIST": return ["ë‹ˆì»·Â·ë¡±ìŠ¤í…Â·í† ë¦¬ì•ˆë„ ì†ë„ ìœ ì§€","í—¤ë“œí¬ì§€ì…˜/ì–¸ë”í›…ìœ¼ë¡œ ë¼ì¸ë¸Œë ˆì´í¬","íŒ¨ìŠ¤â†’ì‚¬ì´ë“œâ†’ë§ˆìš´íŠ¸ ì»¨íŠ¸ë¡¤ ì‹œê°„ í™•ë³´","íƒ‘ ì„œë¸Œ(ì´ˆí¬/ì•”íŠ¸ë¼) ë£¨í‹´ ì •í˜•í™”"];
      case "GUARD_SPECIALIST": return ["ë¦¬í…ì…˜ ë£¨í‹´(ê·¸ë€ë¹„/í™ìŠ¤ì¼€ì´í”„) 5ë¶„","ì–¸ë°¸ëŸ°ì‹±â†’ìŠ¤ìœ• 2-3ë‹¨ ì—°ê²°","ê°€ë“œì—ì„œ ì´ì¤‘ ìœ„í˜‘(ìŠ¤ìœ•+ì„œë¸Œ) ê°ë„ ë§Œë“¤ê¸°","ê·¸ë¦½/í”„ë ˆì„ ë””í…Œì¼ ê°•í™”"];
      case "ALL_ROUNDER": return ["ìƒí™© ì „í™˜ ì˜ì‚¬ê²°ì • ì²´í¬ë¦¬ìŠ¤íŠ¸","ë“ì  ìš°ì„ ìˆœìœ„(íŒ¨ìŠ¤/ë°±/ì„œë¸Œ) ë¶„ê¸° ê·œì¹™","ìƒëŒ€ ìŠ¤íƒ€ì¼ë³„ ì²« 30ì´ˆ ë£¨í‹´","ì¹´ìš´í„° ëŒ€ë¹„ ë¦¬ìŠ¤í¬ ê´€ë¦¬"];
      case "WRESTLER_FIRST": return ["ìŠ¤íƒ ë”© ê·¸ë¦½íŒŒì´íŠ¸â†’ë ˆë²¨ì²´ì¸ì§€ ë£¨í‹´","TD í›„ íƒ‘ ìœ ì§€ 5ì´ˆ ê·œì¹™","íŒ¨ìŠ¤ ì²´ì¸ 2ê°œë¥¼ ê³ ì •í™”","ê°€ë“œ í’€ ëŒ€ë¹„ ì¹´ìš´í„° ì¤€ë¹„"];
      case "LEGLOCK_SYSTEM": return ["ì•„ì‹œâ†’ì™¸ì• ì‹œ ì „í™˜ ì‹œê°„ ë‹¨ì¶•","íí›… í”¼ë‹ˆì‹œ ì„¸ë¶€ ê°ë„/ê·¸ë¦½","ë ˆê·¸ì—ì„œ ìƒì²´ ì „í™˜-ë°± ì—°ê²°","ë ˆê·¸ ë””íœìŠ¤ ë¦¬ìŠ¤í¬ ê´€ë¦¬"];
      case "SUBMISSION_HUNTER": return ["ì„œë¸Œ ì—”íŠ¸ë¦¬ ì „ê°œ ìŠ¤í¬ë¦½íŠ¸í™”","ì„œë¸Œ ì‹¤íŒ¨â†’ì „í™˜ ë¦¬ì»¤ë²„ë¦¬ ê·œì¹™","ì–‘ë©´ ìœ„í˜‘(ì„œë¸Œ+ìŠ¤ìœ•/íŒ¨ìŠ¤) ìœ ì§€","ê·¸ë¦½/ê°ë„ ë¨¼ì € ì„¸íŒ…"];
      case "COUNTER_TEMPO": return ["ê¸¸ë¡œí‹´/ë°± íŠ¸ë© ì§„ì… íƒ€ì´ë°","ìƒëŒ€ ë¦¬ì•¡ì…˜ ìœ ë„ í˜ì¸íŠ¸","í…œí¬ ë³€ì†(ì—…/ë‹¤ìš´) í›ˆë ¨","ë¦¬ìŠ¤í¬ ë‚®ì€ ì¹´ìš´í„° ë£¨íŠ¸ í™•ì¥"];
      default: return ["ì˜¤ëŠ˜ì˜ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸: 'ëœë¤ ì…€ë ‰íŠ¸' ğŸ²","ê°€ë“œ 1ì¢…Â·íŒ¨ìŠ¤ 1ì¢… ê³ ì •í”½ â†’ ì„±ê³µë¥  ê¸°ë¡","ì—…/ë‹¤ìš´ ê¸°ë³¸ ë£¨í‹´ 10ë¶„","ë§‰íŒ ìƒí™© 1ê°œë§Œ ë©”ëª¨í•˜ê³  ë³µê¸°"];
    }
  })();

  // ê³µìœ  ë§í¬
  const payload = {v:4, score, main:main.key, sub:sub?.key||null};
  const encoded = btoa(unescape(encodeURIComponent(JSON.stringify(payload))));
  const shareUrl = `${location.origin}${location.pathname}#r=${encoded}`;

  // í—¤ë“œë¼ì¸
  let headline = `ê²°ê³¼: ${main.name}`;
  let subline  = main.desc;
  if (main.key==="UNDETERMINED"){
    headline = "ê²°ê³¼: íŒë‹¨ ë³´ë¥˜ ğŸ˜…";
    subline  = "ê°€ì¤‘ ì§€í‘œê°€ ê³ ë¥´ê²Œ ë¶„í¬í–ˆìŠµë‹ˆë‹¤. 'ë‹¤ì¬ë‹¤ëŠ¥'ìœ¼ë¡œ í¬ì¥ ê°€ëŠ¥! ë‹¤ìŒ ë¡¤ì—ì„œ íŒíŠ¸ë¥¼ ë” ì£¼ì„¸ìš”.";
  }

  resultEl.innerHTML = `
    <h2>${headline}${sub ? `<span class="cat-badge">ë³´ì¡°: ${sub.name}</span>` : ""}</h2>
    <div class="muted">${subline}</div>

    <div class="grid" style="margin-top:10px">
      <div class="card" style="background:#fff">
        <div class="kpis">
          <div class="kbar">
            <div class="klabel">ê°€ë“œ ì¶•</div>
            <div class="kfill" style="width:${guardPct}%"></div>
            <div class="small muted" style="margin-top:6px">${score.GUARD} / ${totalPerAxisMax} (${guardPct}%)</div>
          </div>
          <div class="kbar">
            <div class="klabel">íƒ‘ ì¶•</div>
            <div class="kfill2" style="width:${topPct}%"></div>
            <div class="small muted" style="margin-top:6px">${score.TOP} / ${totalPerAxisMax} (${topPct}%)</div>
          </div>
        </div>

        <div class="callout" style="margin-top:12px">
          <div class="small muted">ì¼ê´€ì„± ì§€ìˆ˜</div>
          <div style="margin-top:4px;font-weight:700">${consist}%</div>
          <div class="small muted">â€» ìƒìœ„/í•˜ìœ„ ì¶• í¸ì°¨ë¡œ ê³„ì‚° â€” ë†’ì„ìˆ˜ë¡ í•œìª½ ì„±í–¥ì´ ëšœë ·í•©ë‹ˆë‹¤.</div>
        </div>
      </div>

      <div class="card" style="background:#fff">
        <div class="small muted">í•µì‹¬ ë“œë¼ì´ë²„(ìƒìœ„ ì¶•)</div>
        <div class="taglist">
          ${topDrivers.map(h=>`<span class="pill">${h}</span>`).join('') || '<span class="pill">â€”</span>'}
        </div>
        <div class="small muted" style="margin-top:10px">ë‹¹ì‹ ì˜ íƒœê·¸</div>
        <div class="taglist">
          ${topTags.map(t=>`<span class="pill">${t}</span>`).join('') || '<span class="pill">â€”</span>'}
        </div>
      </div>
    </div>

    <div class="card" style="background:#fff;margin-top:12px">
      <div class="small muted">8ì¶• ì„¸ë¶€ ì§€í‘œ</div>
      ${axisBars}
    </div>

    <div class="card" style="background:#fff;margin-top:12px">
      <div class="small muted">ì½”ì¹­ í¬ì¸íŠ¸</div>
      <div class="taglist">${tips.map(x=>`<span class="pill">${x}</span>`).join('')}</div>
    </div>

    <div class="card" style="background:#fff;margin-top:12px">
      <div class="small muted">ê³µìœ </div>
      <div class="sharebox">
        <input class="link" id="shareLink" readonly value="${shareUrl}" />
        <button class="ghost" id="copyBtn">ë§í¬ ë³µì‚¬</button>
        <button class="primary" id="webshareBtn">ê³µìœ í•˜ê¸°</button>
        <button class="ghost" id="retryBtn">ë‹¤ì‹œí•˜ê¸°</button>
      </div>
    </div>
  `;
  resultEl.classList.remove('hidden');

  document.getElementById('copyBtn').onclick = async ()=>{
    try{
      const linkEl = document.getElementById('shareLink');
      linkEl.select(); linkEl.setSelectionRange(0, 99999);
      await navigator.clipboard.writeText(linkEl.value);
      alert('ê³µìœ  ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”!');
    }catch(e){ alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.'); }
  };
  document.getElementById('webshareBtn').onclick = async ()=>{
    const text = `ë‚´ BJJ ê²°ê³¼ â€” ë©”ì¸: ${main.name}${sub?`, ë³´ì¡°: ${sub.name}`:''}`;
    const url = document.getElementById('shareLink').value;
    if (navigator.share){ try{ await navigator.share({title:'BJJ ë¡¤ ìŠ¤íƒ€ì¼', text, url}); }catch(_){}} 
    else { alert('ì´ ê¸°ê¸°ì—ì„œëŠ” ê¸°ë³¸ ê³µìœ ê°€ ì§€ì›ë˜ì§€ ì•Šì•„ìš”. ë§í¬ë¥¼ ë³µì‚¬í•´ ê³µìœ í•´ì£¼ì„¸ìš”!'); }
  };
  document.getElementById('retryBtn').onclick = ()=>{ location.hash=''; location.reload(); };
}

/* ========= ë„¤ë¹„ê²Œì´ì…˜ ========= */
prevBtn.addEventListener('click', ()=>{
  if(idx>0) idx--;
  renderQuestion(idx);
});
nextBtn.addEventListener('click', ()=>{
  const q = Q[idx];
  if(answers[q.id]===undefined){ alert('ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
  if(idx<Q.length-1) idx++;
  renderQuestion(idx);
});
submitBtn.addEventListener('click', showResult);

/* ========= ê³µìœ  ë§í¬ ë³µì› ========= */
function tryRestoreFromHash(){
  const m = location.hash.match(/#r=([^&]+)/);
  if(!m) return false;
  try{
    const json = decodeURIComponent(escape(atob(m[1])));
    const payload = JSON.parse(json);
    if (!payload || payload.v!==4) return false;
    // ì§„í–‰ë°”/ë„¤ë¹„ ì‹œê°ë§Œ ë§ì¶”ê³  ë°”ë¡œ ê²°ê³¼ í‘œì‹œ
    idx = Q.length-1; renderQuestion(idx);
    AXES.forEach(a=>score[a]=payload.score?.[a]||0);
    Q.forEach(q=>answers[q.id]=0); // ì§„í–‰ë°” 100% í‘œí˜„ìš©
    showResult();
    return true;
  }catch(e){ return false; }
}

/* ========= ì´ˆê¸° ë Œë” ========= */
if(!tryRestoreFromHash()){ renderQuestion(0); }
</script>
</body>
</html>
